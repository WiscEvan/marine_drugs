# Autometa Makeflow DAG
LENGTH_FILTER=/home/evan/miniconda3/envs/autometa/bin/autometa-length-filter
COVERAGES=/home/evan/miniconda3/envs/autometa/bin/autometa-coverage
KMERS=/home/evan/miniconda3/envs/autometa/bin/autometa-kmers
ORFS=/home/evan/tools/programs_3rd_party/prokka/binaries/linux/prodigal
MARKERS=/home/evan/miniconda3/envs/autometa/bin/autometa-markers
TAXONOMY=/home/evan/miniconda3/envs/autometa/bin/autometa-taxonomy
BINNING=/home/evan/miniconda3/envs/autometa/bin/autometa-binning
RECRUITMENT=/home/evan/miniconda3/envs/autometa/bin/autometa-unclustered-recruitment

# archaea.unclustered_recruitment.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.binning.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.markers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv
#     $(RECRUITMENT) /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.binning.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.markers.tsv archaea.unclustered_recruitment.tsv --taxonomy /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv --classifier decision_tree

# bacteria.unclustered_recruitment.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.binning.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.markers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv
#     $(RECRUITMENT) /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.binning.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.markers.tsv bacteria.unclustered_recruitment.tsv --taxonomy /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv --classifier decision_tree

# /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.binning.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.markers.tsv  /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.embedded.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv
#     $(BINNING) /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.markers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.binning.tsv --embedded-kmers /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.embedded.tsv --taxonomy /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv --clustering-method dbscan --domain archaea

# /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.binning.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.markers.tsv  /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.embedded.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv
#    $(BINNING) /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.markers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4./home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.binning.tsv --embedded-kmers /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.embedded.tsv --taxonomy /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv --clustering-method dbscan --domain bacteria

/home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.markers.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa
    $(MARKERS) --orfs /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa --kingdom bacteria --hmmscan /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.hmmscan.tsv --out /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.bacteria.markers.tsv --dbdir /home/evan/Autometa/autometa/databases/markers

/home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.markers.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa
    $(MARKERS) --orfs /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa --kingdom archaea --hmmscan /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.hmmscan.tsv --out /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.archaea.markers.tsv --dbdir /home/evan/Autometa/autometa/databases/markers

# /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa : /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna
#     $(TAXONOMY) --assembly /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna --nucl_orfs /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.fna --prot_orfs /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa --blast /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.blastp.tsv --taxon-method majority_vote /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.taxonomy.tsv outdir

/home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa : /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna
    $(ORFS) -a /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.faa -i /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna -d /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.orfs.fna -p meta

/home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.embedded.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna
    $(KMERS) --fasta /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna --kmers /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.tsv --normalized /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.norm.tsv --embedded /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.kmers.embedded.tsv --size 5 --norm-method am_clr --do-pca --pca-dimensions 50 --embed-dimensions 2 --embed-method bhsne

/home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv : /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna
    $(COVERAGES) --from-spades --assembly /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna --out /home/evan/marine_drugs/marine_drugs/data/interim/binning/FL2015_4.coverages.tsv

/home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna : /home/evan/marine_drugs/marine_drugs/data/raw/assemblies/FL2015_4.fasta
    $(LENGTH_FILTER) /home/evan/marine_drugs/marine_drugs/data/raw/assemblies/FL2015_4.fasta /home/evan/marine_drugs/marine_drugs/data/interim/assemblies/FL2015_4.filtered.fna --cutoff 900
